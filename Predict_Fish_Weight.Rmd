---
title: "Weight of Fish"
author: "Brennen Long"
date: "4/12/2021"
output: 
  html_document:
    number_sections: true
    toc: true
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
require(car)
Allfish <- read.csv(file = "Fish.csv")
Allfish$Species <- as.factor(Allfish$Species)
levels(Allfish$Species)
```

```{r}
Perch <- subset(Allfish, Species == "Perch")
Perch <- select(Perch, -Species)
Bream <- subset(Allfish, Species == "Bream")
Bream <- select(Bream, -Species)
Smelt <- subset(Allfish, Species == "Smelt")
Smelt <- select (Smelt, -Species )
```


#Perch Model

## Results

```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Perch,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")
summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="bottom",main="Adjusted R^2")
```

According to the automation, the best 2 variables for predicting Weight are Height and Width, because (according to the graphic) the Height- Width model has a greater Adjusted R-square value than all the other ones, at ~.94, or 94%.  

```{r}
which.max(summary.out$adjr2)
```

The model with those 2 variables has the greatest Adjusted R-squared, meaning it explains the greatest percentage of the data in Perch.  
  
```{r}
best.model <- lm(Weight~ Height + Width,data=Perch)
summary(best.model)
```

An Adjusted R-squared value of 0.94 means 94% of the length values can be explained by this model, which is incredibly useful (especially considering such a low p-value).  

## Inferential Results.

```{r}
fullup <- lm(Weight~ .,data=Perch)
summary.lm(fullup)
```

Height and Width have the lowest p-values, making them the most important variables. This model (including every variable) also has a slightly lower Adjusted R-squared value, making it less useful to us than the 2-variable model used earlier.  


## Descriptive Results

### Graphical Descriptive Results

<!--Graphical results here.  Make sure to show your code.  Provide appropriate labels for axes, giving units if possible, and provide a good title for the graph, too.  Use the graphical results to describe the patterns if any that exist in the data as focused toward the research question!-->

### Numerical Descriptive Results

<!--Numerical results go here. Use the numerical results to describe the patterns if any that exist in the data as focused toward the research question!-->

## Inferential Results

<!--State hypothesis clearly.  Make sure your discussion of the inferential test covers all the aspects that the test output produces, such as test statistic, p-value etc.  Make a decision about the null hypothesis, explain the assumptions on which the selected test/procedure was based, and why the chosen procedure satisfys the assumptions and is appropriate to answer the research question!-->


# Discussion and Conclusion

<!--Discussion and conclusion here.  If you found a relationship be sure to consider whether the relationship occurs because one of the variavbles causes the other, or whether they perhasps are related for some other reason.  Watch the chapter 6 videos from the GeorgeTown videos collection.!-->
